"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[843],{18452:(e,t,a)=>{a.d(t,{RealtimeProvider:()=>o,x:()=>l});var s=a(95155),n=a(12115),i=a(87481);let r=(0,n.createContext)(void 0);function o(e){let{children:t}=e,[a,o]=(0,n.useState)([]),[l,d]=(0,n.useState)([]),[c,u]=(0,n.useState)(null),[m,p]=(0,n.useState)(!0),{toast:f}=(0,i.dj)();return(0,n.useEffect)(()=>{let e=localStorage.getItem("currentTimetable"),t=localStorage.getItem("timetableUpdates"),a=localStorage.getItem("liveClasses");e&&u(JSON.parse(e)),t&&o(JSON.parse(t)),a&&d(JSON.parse(a));let s=setInterval(()=>{p(e=>(e||f({title:"\uD83D\uDD04 Reconnected",description:"Real-time updates are now active"}),!0))},3e4);return()=>clearInterval(s)},[f]),(0,n.useEffect)(()=>{let e=e=>{if("timetableUpdates"===e.key&&e.newValue){let t=JSON.parse(e.newValue);o(t);let a=t[t.length-1];a&&Date.now()-a.timestamp<1e4&&f({title:"\uD83D\uDCE2 Timetable Updated",description:a.message})}if("liveClasses"===e.key&&e.newValue){let t=JSON.parse(e.newValue);d(t);let a=t.find(e=>"live"===e.status);a&&f({title:"\uD83D\uDD34 Live Class Started",description:"".concat(a.subjectName," with ").concat(a.facultyName)})}"currentTimetable"===e.key&&e.newValue&&(u(JSON.parse(e.newValue)),f({title:"\uD83D\uDCC5 Live Timetable Update",description:"New timetable published by administration"}))},t=e=>{"timetableUpdate"===e.detail.type&&(u(e.detail.data),o([...a,{id:"update-".concat(Date.now()),type:"timetable_change",timestamp:Date.now(),message:e.detail.message,data:e.detail.data,affectedUsers:["student","faculty"]}]),f({title:"\uD83D\uDCE2 Timetable Updated",description:e.detail.message}))};return window.addEventListener("storage",e),window.addEventListener("timetableUpdate",t),window.addEventListener("internalTimetableUpdate",e=>{"timetableUpdate"===e.detail.type&&(u(e.detail.data),f({title:"\uD83D\uDCC5 Internal Sync Complete",description:"Timetable updated in real-time"}))}),()=>{window.removeEventListener("storage",e),window.removeEventListener("timetableUpdate",t)}},[f,a]),(0,s.jsx)(r.Provider,{value:{updates:a,liveClasses:l,currentTimetable:c,isConnected:m,publishTimetableUpdate:(e,t)=>{let s=[...a,{id:"update-".concat(Date.now()),type:"timetable_change",timestamp:Date.now(),data:e,message:t,affectedUsers:["student","faculty"]}];o(s),u(e),localStorage.setItem("timetableUpdates",JSON.stringify(s)),localStorage.setItem("currentTimetable",JSON.stringify(e)),setTimeout(()=>{window.dispatchEvent(new CustomEvent("internalTimetableUpdate",{detail:{type:"timetableUpdate",data:e,message:t,timestamp:Date.now()}})),window.dispatchEvent(new StorageEvent("storage",{key:"currentTimetable",newValue:JSON.stringify(e),oldValue:null,storageArea:localStorage,url:window.location.href}))},50),f({title:"✅ Timetable Published",description:"Real-time sync to all students and faculty completed"})},startLiveClass:e=>{let t={...e,status:"live"},s=[...l.filter(t=>t.id!==e.id),t];d(s),localStorage.setItem("liveClasses",JSON.stringify(s));let n=[...a,{id:"live-".concat(Date.now()),type:"live_class",timestamp:Date.now(),data:t,message:"Live class started: ".concat(e.subjectName," in ").concat(e.room),affectedUsers:["student","faculty"]}];o(n),localStorage.setItem("timetableUpdates",JSON.stringify(n)),f({title:"\uD83D\uDD34 Live Class Started",description:"".concat(e.subjectName," is now live in ").concat(e.room)})},endLiveClass:e=>{let t=l.map(t=>t.id===e?{...t,status:"ended"}:t);d(t),localStorage.setItem("liveClasses",JSON.stringify(t));let a=l.find(t=>t.id===e);a&&f({title:"⏹️ Live Class Ended",description:"".concat(a.subjectName," class has ended")})},sendAnnouncement:(e,t)=>{let s=[...a,{id:"announcement-".concat(Date.now()),type:"announcement",timestamp:Date.now(),data:{message:e},message:e,affectedUsers:t}];o(s),localStorage.setItem("timetableUpdates",JSON.stringify(s)),f({title:"\uD83D\uDCE2 Announcement Sent",description:"Message sent to ".concat(t.join(", "))})},markUpdateAsRead:e=>{let t=JSON.parse(localStorage.getItem("readUpdates")||"[]");t.includes(e)||(t.push(e),localStorage.setItem("readUpdates",JSON.stringify(t)))},joinLiveClass:e=>{let t=l.find(t=>t.id===e);t&&t.meetingLink?(window.open(t.meetingLink,"_blank"),f({title:"\uD83D\uDE80 Joining Live Class",description:"Opening ".concat(t.subjectName," class")})):f({title:"\uD83D\uDCCD Live Class Location",description:"Please go to ".concat((null==t?void 0:t.room)||"assigned room")})}},children:t})}function l(){let e=(0,n.useContext)(r);if(void 0===e)throw Error("useRealtime must be used within a RealtimeProvider");return e}},26126:(e,t,a)=>{a.d(t,{E:()=>o});var s=a(95155);a(12115);var n=a(74466),i=a(59434);let r=(0,n.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,...n}=e;return(0,s.jsx)("div",{className:(0,i.cn)(r({variant:a}),t),...n})}},30285:(e,t,a)=>{a.d(t,{$:()=>d});var s=a(95155),n=a(12115),i=a(66634),r=a(74466),o=a(59434);let l=(0,r.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:a,variant:n,size:r,asChild:d=!1,...c}=e,u=d?i.DX:"button";return(0,s.jsx)(u,{className:(0,o.cn)(l({variant:n,size:r,className:a})),ref:t,...c})});d.displayName="Button"},59434:(e,t,a)=>{a.d(t,{cn:()=>i});var s=a(52596),n=a(39688);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,s.$)(t))}},68437:(e,t,a)=>{a.d(t,{A:()=>d,AuthProvider:()=>l});var s=a(95155),n=a(35695),i=a(12115);let r=(0,i.createContext)(void 0),o="frosty-user-session";function l(e){let{children:t}=e,[a,l]=(0,i.useState)(null),[d,c]=(0,i.useState)(!0),u=(0,n.useRouter)();(0,i.useEffect)(()=>{try{let e=localStorage.getItem(o);e&&l(JSON.parse(e))}catch(e){localStorage.removeItem(o)}c(!1)},[]);let m=(0,i.useCallback)(e=>{l(e),localStorage.setItem(o,JSON.stringify(e)),u.push("/")},[u]),p=(0,i.useCallback)(()=>{l(null),localStorage.removeItem(o),u.push("/login")},[u]),f=(0,i.useCallback)(e=>(null==a?void 0:a.role)===e,[a]),g=(0,i.useCallback)(e=>!!a&&e.includes(a.role),[a]);return(0,s.jsx)(r.Provider,{value:{user:a,loading:d,login:m,logout:p,hasRole:f,hasAnyRole:g},children:t})}function d(){let e=(0,i.useContext)(r);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},87481:(e,t,a)=>{a.d(t,{dj:()=>m});var s=a(12115);let n=0,i=new Map,r=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?r(a):e.toasts.forEach(e=>{r(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,a=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=s.useState(d);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}}]);